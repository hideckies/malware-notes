import { defineCollection, z } from "astro:content";

const malwareFamiliesCollection = defineCollection({
    type: 'content',
    schema: z.object({
        title: z.string(),
        description: z.string(),
        aka: z.array(z.string()),
        identified: z.number(),
        types: z.array(z.string()),
        platforms: z.array(z.string()),
        developers: z.array(z.string()),
        actors: z.array(z.string()),
        initialVectors: z.array(z.string()),
        langs: z.array(z.string()),
        features: z.array(z.string()),
        targets: z.array(z.string()),
        notes: z.array(z.string()),
        refs: z.array(z.string()),
        pubDate: z.date(),
    })
});

const threatActorsCollection = defineCollection({
    type: 'content',
    schema: z.object({
        title: z.string(),
        description: z.string(),
        aka: z.array(z.string()),
        identified: z.number(),
        motivations: z.array(z.string()),
        countries: z.array(z.string()),
        affiliated: z.array(z.string()),
        initialVectors: z.array(z.string()),
        malwares: z.array(z.string()),
        targets: z.array(z.string()),
        refs: z.array(z.string()),
        pubDate: z.date(),
    })
})

export const collections = {
    malwareFamilies: malwareFamiliesCollection,
    threatActors: threatActorsCollection,
};
